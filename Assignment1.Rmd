---
title: "Reproducible Research Assignment 1"
date: "12/8/2020"
output: html_document
---

# Load and process data 

```{r echo=TRUE}
unzip(zipfile="activity.zip")
activity <-read.csv("activity.csv")
```



# What is the mean total number of steps taken per day?

## Total number of steps taken per day
```{r echo=TRUE}
stepsPerDay <-tapply(activity$steps, activity$date, sum, na.rm=TRUE)
stepsPerDay
```


## Histogram of total number of steps taken each day
```{r echo=TRUE}
hist(stepsPerDay, xlab="Number of Steps", main="Total number of steps taken each day")
```


## Mean and median of total steps taken per day
```{r echo=TRUE}
median(stepsPerDay)
mean(stepsPerDay)
```

The mean and median of the total number of steps taken per day are 9354.23 and 10395, respectively. 


# What is the average daily activity pattern?

## Time series plot of the 5-minute interval and the average number of steps taken
```{r echo=TRUE}
averagePerDay <-tapply(activity$steps, activity$interval, mean, na.rm=TRUE)
plot(averagePerDay, xlab="5-Minute Interval", ylab = "Average Number of Steps", type="l", main="Average Number of steps taken Per Day Per 5-Minute Interval")
```


## Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r}
names(which.max(averagePerDay))
```

The 835th interval contains the maximum number of steps. 


## Inputing missing values


# Total number of missing values in the dataset 
```{r}
sum(is.na(activity))
```

There are 2304 missing values in the dataset.


# Strategy for filling in missing values and new data set 
```{r}
meaninterval <-aggregate(steps~interval, activity, FUN=mean)
activityNew <-merge(activity, meaninterval, by="interval")
activityNew$steps <-ifelse(is.na(activityNew$steps.x), activityNew$steps.y, activityNew$steps.x)
activityNew <-activityNew[,c(1,3,5)]
head(activityNew)
```

                        
# Histogram, mean, and median

```{r}
stepsPerDayN <-tapply(activityNew$steps, activityNew$date, sum, na.rm=TRUE)
hist(stepsPerDayN, xlab="Number of Steps", main="Total number of steps taken each day")

median(stepsPerDayN)
mean(stepsPerDayN)
```

The mean and median for the total number of steps taken per day for the new data set are both 10766.19. These are slightly higher than the estiamtes found using the data set with missing values. As the mean was used to imput missing data, using the median or other methods may yield different results. 